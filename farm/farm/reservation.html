<!doctype html>
<html>
    <head>
        <meta charset="utf8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/> 
		<link rel="stylesheet" href="www/global.css" type="text/css" media="screen" title="no title" charset="utf-8">
		
        <style type="text/css">
		* {
		   -webkit-transition: all 0.3s;
		}
		body {
			margin: 0px;
			overflow: hidden;
		}
		.addToCart {
			position: fixed;
			bottom: 0;
		}
		.addToCart .count {
			margin-bottom: 4px;
			margin-left: 10px;
			width: 300px;
			height: 66px;			
			-webkit-box-shadow: 2px 3px 5px gray;
			box-shadow: 2px 3px 5px #000000;
			background-color:rgba(255, 255, 255, 0.8);
			-webkit-overflow-scrolling: touch;
			-webkit-box-shadow: 5px 5px 28px #555;
			box-shadow: 5px 5px 28px #555;
		}
		.addToCart img {			
			width: 300px;
		}
		.count .cost {
			margin-left: 20px;
			display: inline-block;
			line-height: 64px;
			color: #4fbd97;
			font-size: 32px;
		}
		.count .caculator {
			position: absolute;
			top: 16px; right: 24px;
			display: inline-block;			
		}
		.caculator .operator {
			display: inline-block;		
			width: 32px; height: 32px;
			line-height: 34px;
			text-align: center;
			border-radius: 4px;
			background: #fa6649;
			color: white;
			opacity: 1;
/*			font-size: 34px;*/
		}
		.caculator .operator:active {
			background: #aa6649;
		}
		.caculator .mount {
			display: inline-block;		
			width: 32px; height: 32px;
			line-height: 34px;
			text-align: center;
			border-radius: 4px;
			background: white;
/*			box-sizing: border-box;*/
			border: 1px solid #fa6649;
			color: grey;
/*			font-size: 24px;*/
		}
		.arrow {
		}
		.arrow img.left {
			position: absolute;
			left: 0px;
			top: 30%;
			width: 30px;
		}
		.arrow img.right {
			position: absolute;
			right: 0px;
			top: 30%;
			width: 30px;
			-webkit-transform: rotate(180deg);
		}
		.topMenu {			
			position: absolute;
			top: 0;
			margin-left: 5px;
			margin-right: -5px;
/*			left: 10px;*/
			height: 32px;			
			overflow-x: scroll;
/*			overflow-y: hidden;*/
			-webkit-overflow-scrolling: touch;
			-webkit-box-shadow: 5px 5px 28px #666;
			box-shadow: 5px 5px 28px #666;
			
		}
		.topMenu ul {
			width: 400%;
			margin-top: 0px;
			margin-left: -40px;
			list-style: none;
			white-space: nowrap;
		}
		.topMenu ul li {
			width: 56px;
			height: 24px;
			line-height: 25px;
			text-align: center;
			display: inline-block;
			padding: 4px 10px;
			float: left;
/*			background: #231F20;*/
			background: #DDD url('www/切换标题.png') no-repeat 10% 20%;
			 -webkit-transition: none;
			color: #65dfb5;
			font-weight: bold;
			border-right: 1px dashed white;
		}
		.topMenu ul li:last-child {
			border-right: none;
		}
		.topMenu ul li.current {
			background: #4fbd97;
			color: white;
		}
		.food-list {
			width: 1000%;
			-webkit-transition: all .3s;
		}
		.food-item {			
			margin-top: 42px;
			display: inline-block;
			width: 10%;
			text-align: center; 
		}
		#opMinus:active, #opPlus:active {
			opacity: 0.7;
		}
		.font-yahei {
		    font-family: Microsoft YaHei;
		}			
		.about {
			position: relative;
		}	
		.about .title {
			position: absolute;
			top: 16px;
			left: 130px;
			font-size: 14px;
			text-align: left;
		}
		.about .content {
			position: absolute;
			top: 70px;
			left: 70px;
			padding-top: 8px;
			height: 124px;
			width: 184px;
			text-align: left;
			overflow: scroll;
			-webkit-overflow-scrolling: touch;
			border-top: 1px #fff dashed;
			font-size: 12px;
		}
		.about .icon {
			position: absolute;
			top: 16px;
			left: 66px;
			height: 30px;
			width: 30px;
/*			background: #faa;*/
		}
        </style>
    </head>
    <body>
		<script id="foodItemTpl" type="text/template">
			<div class="food-item">
				<img class='foodImg' src="{{foodImg}}" width="240px" />
				<div class="about" style="display:none">
					<img class="aboutBg" src="www/reservation/foods/about.png" width="240px" />
					<div class="icon">
						<img src="{{aboutIcon}}" width="50" alt="印章">
					</div>
					<div class="title">
						{{title}}
					</div>
					
					<div class="content">
						{{content}}
					</div>
				</div>
			</div>
		</script>
		<div class="topMenu">
			<ul id="listMenu">
				<li class="current">西兰花</li>
				<li>番茄</li>
				<li>紫甘蓝</li>
				<li>草莓</li>
				<li>芦笋</li>
			</ul>
		</div>
		<div id="food-list" class="food-list">
			<div class="food-item">
				<img class='foodImg' src="www/reservation/foods/xilanhua.png" width="240px" />
				<div class="about" style="display:none">
					<img class="aboutBg" src="www/reservation/foods/about.png" width="240px" />
					<div class="icon">
						<img src="www/reservation/foods/关于西兰花-印章.png" width="50" alt="关于西兰花 印章">
					</div>
					<div class="title">
						栽培到收获：10周<br>
						栽培季节：夏季
					</div>
					
					<div class="content">
						番茄，为一年生茄科草本植物。果实营养丰富，具特殊风味。具有减肥瘦身、消除疲劳、增进食欲、提高对蛋白质的消化、减少胃胀食积等功效。由于番茄中维生素A、维生素C的比例合适，所以常吃可增强小血管功能，预防血管老化。另外，还可以美容和治愈口疮（可含些番茄汁，使其接触疮面，每次数分钟，每日数次，效果显著）。
					</div>
				</div>
			</div>
			<div class="food-item">
				<img class='foodImg' src="www/reservation/foods/fanqie.png" width="240px" />
			</div>
			<div class="food-item">
				<img class='foodImg' src="www/reservation/foods/ziganlan.png" width="240px" />
			</div>
			<div class="food-item">
				<img class='foodImg' src="www/reservation/foods/caomei.png" width="240px" />
			</div>
			<div class="food-item">
				<img class='foodImg' src="www/reservation/foods/lusun.png" width="240px" />
			</div>
		</div>		
		
		<div class="arrow">
			<img class="left" src="www/arrow.png" alt="Arrow">
			<img class="right" src="www/arrow.png" alt="Arrow">
		</div>
		<div class="addToCart">
			<div class="count">
				
				<div class="cost">
					<img src="www/tmp_price.png" style="width: 94px; margin-top: 14px; margin-left: 8px" />
					<!-- <span class="font-yahei" style="margin-left: 3px;">¥</span>
					<span class="font-yahei" style="margin-left: -4px">27</span>
					<img style="width: 20px;margin-left: -17px;vertical-align: -14px;" src="www/slash.png" />
					<span style="font-size: 16px;margin-left: -16px;vertical-align: -10px;">株</span>			 -->		
				</div>
				<div class="caculator">
					<img id="opMinus" src="www/btnMinus.png" style="width: 33px;vertical-align:bottom" />	
					<div id="count" class="mount">0</div>									
					<img id="opPlus" src="www/btnPlus.png" style="width: 33px;vertical-align:bottom" />				
				</div>
			</div>
			<img style="margin-left:16px;margin-bottom:-10px" class="" src="www/add-to-cart.png" alt="Add To Cart">
		</div>
		
		<script type="text/javascript" src="www/zepto.min.js"></script>
		<script type="text/javascript">
		
		//渲染函数
		function render(data, tpl) {
			var str = "";
			var tmpTpl;
			$.each(data, function(index, item) {
				tmpTpl = tpl;
				for (var key in item) {				
					tmpTpl = tmpTpl.replace("{{"+ key +"}}", item[key]);
				}
				str += tmpTpl;				
			});			
			return str;
		}
		
		var data = [
		{
			foodImg: 'www/reservation/foods/xilanhua.png',
			aboutIcon: 'www/reservation/foods/关于西兰花-印章.png',
			title: '栽培到收获：13周<br>栽培季节：秋季',
			content: '西兰花，富含丰富维生素C和膳食纤维，还含有具强效抗癌性能的多种营养成分, 如二吲哚甲烷和少量硒。每一百克西兰花就含有89.2毫克的维他命C。当中发现一种叫做3,3\'-二吲哚甲烷的物质，对人的先天免疫系统好比一个有效的调制器，具有抗病毒，抗细菌和抗肿瘤活性作用。'
		},
		{
			foodImg: 'www/reservation/foods/fanqie.png',
			aboutIcon: 'www/reservation/foods/关于番茄-印章.png',
			title: '栽培到收获：10周<br>栽培季节：夏季',
			content: '番茄，为一年生茄科草本植物。果实营养丰富，具特殊风味。具有减肥瘦身、消除疲劳、增进食欲、提高对蛋白质的消化、减少胃胀食积等功效。由于番茄中维生素A、维生素C的比例合适，所以常吃可增强小血管功能，预防血管老化。另外，还可以美容和治愈口疮（可含些番茄汁，使其接触疮面，每次数分钟，每日数次，效果显著）。'
		},
		{
			foodImg: 'www/reservation/foods/ziganlan.png',
			aboutIcon: 'www/reservation/foods/关于紫甘蓝-印章.png',
			title: '栽培到收获：10周<br>栽培季节：夏季',
			content: '番茄，为一年生茄科草本植物。果实营养丰富，具特殊风味。具有减肥瘦身、消除疲劳、增进食欲、提高对蛋白质的消化、减少胃胀食积等功效。由于番茄中维生素A、维生素C的比例合适，所以常吃可增强小血管功能，预防血管老化。另外，还可以美容和治愈口疮（可含些番茄汁，使其接触疮面，每次数分钟，每日数次，效果显著）。'
		},
		{
			foodImg: 'www/reservation/foods/caomei.png',
			aboutIcon: 'www/reservation/foods/关于草莓-印章.png',
			title: '栽培到收获：10周<br>栽培季节：夏季',
			content: '番茄，为一年生茄科草本植物。果实营养丰富，具特殊风味。具有减肥瘦身、消除疲劳、增进食欲、提高对蛋白质的消化、减少胃胀食积等功效。由于番茄中维生素A、维生素C的比例合适，所以常吃可增强小血管功能，预防血管老化。另外，还可以美容和治愈口疮（可含些番茄汁，使其接触疮面，每次数分钟，每日数次，效果显著）。'
		},
		{
			foodImg: 'www/reservation/foods/lusun.png',
			aboutIcon: 'www/reservation/foods/关于芦笋-印章.png',
			title: '栽培到收获：10周<br>栽培季节：夏季',
			content: '番茄，为一年生茄科草本植物。果实营养丰富，具特殊风味。具有减肥瘦身、消除疲劳、增进食欲、提高对蛋白质的消化、减少胃胀食积等功效。由于番茄中维生素A、维生素C的比例合适，所以常吃可增强小血管功能，预防血管老化。另外，还可以美容和治愈口疮（可含些番茄汁，使其接触疮面，每次数分钟，每日数次，效果显著）。'
		}
		];
		
		$(function(){
			var template = $('#foodItemTpl').html();	
								
			$('#food-list').html( render(data, template) );				
							
		});		
		
		$('#food-list').on('tap', '.food-item', function(ev) {
			$(this).find('.foodImg').hide();
			$(this).find('.about').show();
		});
		
		$('#food-list').on('tap', '.icon', function(ev) {
			$(this).parents('.food-item').find('.foodImg').show();
			$(this).parents('.food-item').find('.about').hide();
		});
		// (function($){
			
			var count = 0;
			var countText = $('#count');
			var topMenuList = $('#listMenu li');
			var foodList = $('#food-list');
			var mvStep = 10.2,
				translateX = 0,
				leftBound = 0;
				rightBound = ($('#food-list .food-item').length - 1) * - mvStep,
				currentIndex = 0; 
			var menuWidth = 74,
				menuMarginLeft = 10,
				des = window.screen.width - menuWidth;			
			
			
			$('#listMenu').on('tap', 'li', function(ev) {

				selectItem($(this).index())
			});
		
			$('#opMinus').on('tap', function(ev) {
				count>0 && countText.html(--count);
				count = count < 0 ? 0 : count; 			
			});
		
			$('#opPlus').on('tap', function(ev) {
				countText.html(++count);
			});
		
			$('.arrow .left').on('tap', function(ev) {
				if(translateX >= leftBound) return;
				translateX += mvStep;
				foodList.css('-webkit-transform', "translateX("+ translateX +"%)");
				
				currentIndex --;
				selectItem(currentIndex);
			});
			$('.arrow .right').on('tap', function(ev) {
				if(translateX <= rightBound) return;
				translateX -= mvStep;
				foodList.css('-webkit-transform', "translateX("+ translateX +"%)");		
				
				currentIndex ++;	
				selectItem(currentIndex);
			});
			function selectItem(index) {				
				topMenuList.removeClass('current');
				topMenuList[index].className = "current";
				moveMenuItemToScreen($(topMenuList[index]));
			}
			function moveMenuItemToScreen(item) {
				var left = item.offset().left,
					right = item.offset().left + menuWidth;
				if(left > des) {
					$('.topMenu').scrollLeft(left);
					$('.topMenu').css({
						'margin-left': '-5px',
						'margin-right': '5px'
					});
				}
				if(right < menuWidth + menuMarginLeft) {
					console.log('moving right');
					$('.topMenu').scrollLeft(left-10);
					// $('.topMenu').scrollLeft(left);
					$('.topMenu').css({
						'margin-left': '5px',
						'margin-right': '-5px'
					});
				}
			}
		// })(Zepto);
		
		</script>
    </body>
</html>